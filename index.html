<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>测试页面</title>
  <style>
    body { font-family: "微软雅黑", sans-serif; margin: 20px; }
    #weather { 
      display: flex; 
      align-items: center; 
      gap: 10px; 
      margin-top: 20px; 
      padding: 10px; 
      border: 1px solid #ccc; 
      border-radius: 8px;
      max-width: 350px;
    }
    #weather img { width: 50px; height: 50px; }
    select { margin-top: 10px; padding: 5px; }
  </style>
</head>
<body>
  <h1>Hi，网站运行正常！</h1>

  <!-- 城市选择 -->
  <label for="city-select">选择城市：</label>
  <select id="city-select">
    <option value="101010100">北京</option>
    <option value="101020100">上海</option>
    <option value="101280101">广州</option>
    <option value="101210101">武汉</option>
    <option value="101030100">天津</option>
    <option value="101190101">香港</option>
    <option value="101140101">西安</option>
    <option value="101040100">重庆</option>
    <option value="101230101">杭州</option>
    <option value="101250101">成都</option>
    <!-- 可以继续添加世界主要城市的Location ID -->
  </select>

  <!-- 天气模块 -->
  <div id="weather">
    <img id="weather-icon" src="" alt="天气图标">
    <div>
      <p id="weather-city">城市: 加载中...</p>
      <p id="weather-info">天气: 加载中...</p>
      <p id="weather-temp">温度: 加载中...</p>
    </div>
  </div>

  <p>Copyright © 2025 晓楠瓜. All Rights Reserved.</p>

  <script>
    const API_HOST = 'devapi.qweather.com'; // 和风天气官方 API Host
    const API_KEY = '05beb2ec0f884c25b8084d6749f37a36';

    const weatherCity = document.getElementById("weather-city");
    const weatherInfo = document.getElementById("weather-info");
    const weatherTemp = document.getElementById("weather-temp");
    const weatherIcon = document.getElementById("weather-icon");
    const citySelect = document.getElementById("city-select");

    async function fetchWeather(locationId) {
      try {
        const url = `https://${API_HOST}/v7/weather/now?location=${locationId}&key=${API_KEY}&lang=zh`;
        const res = await fetch(url);
        const data = await res.json();
        const now = data.now;
        const cityName = citySelect.options[citySelect.selectedIndex].text;
        weatherCity.textContent = `城市: ${cityName}`;
        weatherInfo.textContent = `天气: ${now.text}`;
        weatherTemp.textContent = `温度: ${now.temp}°C`;
        // 使用官方图标 URL
        weatherIcon.src = `https://cdn.qweather.com/icons/${now.icon}.png`;
        weatherIcon.alt = now.text;
      } catch (err) {
        console.error(err);
        weatherCity.textContent = "城市: 获取失败";
        weatherInfo.textContent = "天气: 获取失败";
        weatherTemp.textContent = "温度: 获取失败";
        weatherIcon.src = "";
      }
    }

    // 初次加载默认城市
    fetchWeather(citySelect.value);

    // 当用户选择城市变化时
    citySelect.addEventListener("change", () => {
      fetchWeather(citySelect.value);
    });
  </script>
</body>
</html>
